============================================================================================== 
Warning! Mixing Conda and module environments may lead to corruption of the
user environment. 
We do not recommend users mixing those two environments unless absolutely
necessary. Note that 
SURF does not provide any support for Conda environment.
For more information, please refer to our software policy page:
https://servicedesk.surf.nl/wiki/display/WIKI/Software+policy+Snellius+and+Lisa#SoftwarepolicySnelliusandLisa-UseofAnacondaandMinicondaenvironmentsonSnellius 

Remember that many packages have already been installed on the system and can
be loaded using 
the 'module load <package__name>' command. If you are uncertain if a package is
already available 
on the system, please use 'module avail' or 'module spider' to search for it.
============================================================================================== 
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<10:58,  1.52it/s]  0%|          | 4/1000 [00:00<02:31,  6.58it/s]  1%|          | 8/1000 [00:00<01:19, 12.52it/s]  1%|          | 12/1000 [00:01<00:57, 17.17it/s]  2%|▏         | 16/1000 [00:01<00:47, 20.70it/s]  2%|▏         | 20/1000 [00:01<00:41, 23.34it/s]  2%|▏         | 24/1000 [00:01<00:38, 25.26it/s]  3%|▎         | 28/1000 [00:01<00:36, 26.65it/s]  3%|▎         | 31/1000 [00:01<00:35, 27.44it/s]  4%|▎         | 35/1000 [00:01<00:34, 28.25it/s]  4%|▍         | 39/1000 [00:01<00:33, 28.80it/s]  4%|▍         | 43/1000 [00:02<00:32, 29.17it/s]  5%|▍         | 47/1000 [00:02<00:32, 29.43it/s]  5%|▌         | 50/1000 [00:02<00:32, 29.57it/s]  5%|▌         | 54/1000 [00:02<00:31, 29.71it/s]  6%|▌         | 58/1000 [00:02<00:31, 29.81it/s]  6%|▌         | 62/1000 [00:02<00:31, 29.80it/s]  6%|▋         | 65/1000 [00:02<00:31, 29.84it/s]  7%|▋         | 69/1000 [00:02<00:31, 29.90it/s]  7%|▋         | 73/1000 [00:03<00:30, 29.94it/s]  8%|▊         | 77/1000 [00:03<00:30, 29.97it/s]  8%|▊         | 81/1000 [00:03<00:30, 29.99it/s]  8%|▊         | 85/1000 [00:03<00:30, 30.00it/s]  9%|▉         | 89/1000 [00:03<00:30, 30.02it/s]  9%|▉         | 93/1000 [00:03<00:30, 30.03it/s] 10%|▉         | 97/1000 [00:03<00:30, 30.03it/s] 10%|█         | 101/1000 [00:03<00:29, 30.02it/s] 10%|█         | 105/1000 [00:04<00:29, 30.02it/s] 11%|█         | 109/1000 [00:04<00:29, 30.03it/s] 11%|█▏        | 113/1000 [00:04<00:29, 30.04it/s] 12%|█▏        | 117/1000 [00:04<00:29, 30.04it/s] 12%|█▏        | 121/1000 [00:04<00:29, 30.05it/s] 12%|█▎        | 125/1000 [00:04<00:29, 30.05it/s] 13%|█▎        | 129/1000 [00:04<00:28, 30.05it/s] 13%|█▎        | 133/1000 [00:05<00:28, 30.05it/s] 14%|█▎        | 137/1000 [00:05<00:28, 30.05it/s] 14%|█▍        | 141/1000 [00:05<00:28, 30.05it/s] 14%|█▍        | 145/1000 [00:05<00:28, 30.05it/s] 15%|█▍        | 149/1000 [00:05<00:28, 30.05it/s] 15%|█▌        | 153/1000 [00:05<00:28, 30.06it/s] 16%|█▌        | 157/1000 [00:05<00:28, 30.06it/s] 16%|█▌        | 161/1000 [00:05<00:27, 30.06it/s] 16%|█▋        | 165/1000 [00:06<00:27, 30.06it/s] 17%|█▋        | 169/1000 [00:06<00:27, 30.06it/s] 17%|█▋        | 173/1000 [00:06<00:27, 30.05it/s] 18%|█▊        | 177/1000 [00:06<00:27, 30.05it/s] 18%|█▊        | 181/1000 [00:06<00:27, 30.06it/s] 18%|█▊        | 185/1000 [00:06<00:27, 30.06it/s] 19%|█▉        | 189/1000 [00:06<00:26, 30.06it/s] 19%|█▉        | 193/1000 [00:07<00:26, 30.06it/s] 20%|█▉        | 197/1000 [00:07<00:26, 30.06it/s] 20%|██        | 201/1000 [00:07<00:26, 30.06it/s] 20%|██        | 205/1000 [00:07<00:26, 30.06it/s] 21%|██        | 209/1000 [00:07<00:26, 30.07it/s] 21%|██▏       | 213/1000 [00:07<00:26, 30.01it/s] 22%|██▏       | 217/1000 [00:07<00:26, 30.02it/s] 22%|██▏       | 221/1000 [00:07<00:25, 30.03it/s] 22%|██▎       | 225/1000 [00:08<00:25, 29.94it/s] 23%|██▎       | 229/1000 [00:08<00:25, 29.98it/s] 23%|██▎       | 233/1000 [00:08<00:25, 30.00it/s] 24%|██▎       | 237/1000 [00:08<00:25, 30.02it/s] 24%|██▍       | 241/1000 [00:08<00:25, 30.03it/s] 24%|██▍       | 245/1000 [00:08<00:25, 30.05it/s] 25%|██▍       | 249/1000 [00:08<00:24, 30.05it/s] 25%|██▌       | 253/1000 [00:09<00:24, 30.03it/s] 26%|██▌       | 257/1000 [00:09<00:24, 30.04it/s] 26%|██▌       | 261/1000 [00:09<00:24, 30.05it/s] 26%|██▋       | 265/1000 [00:09<00:24, 30.05it/s] 27%|██▋       | 269/1000 [00:09<00:24, 30.06it/s] 27%|██▋       | 273/1000 [00:09<00:24, 30.06it/s] 28%|██▊       | 277/1000 [00:09<00:24, 30.06it/s] 28%|██▊       | 281/1000 [00:09<00:23, 30.06it/s] 28%|██▊       | 285/1000 [00:10<00:23, 30.06it/s] 29%|██▉       | 289/1000 [00:10<00:23, 30.06it/s] 29%|██▉       | 293/1000 [00:10<00:23, 30.06it/s] 30%|██▉       | 297/1000 [00:10<00:23, 30.07it/s] 30%|███       | 301/1000 [00:10<00:23, 30.07it/s] 30%|███       | 305/1000 [00:10<00:23, 30.07it/s] 31%|███       | 309/1000 [00:10<00:22, 30.07it/s] 31%|███▏      | 313/1000 [00:11<00:22, 30.06it/s] 32%|███▏      | 317/1000 [00:11<00:22, 30.06it/s] 32%|███▏      | 321/1000 [00:11<00:22, 30.07it/s] 32%|███▎      | 325/1000 [00:11<00:22, 30.07it/s] 33%|███▎      | 329/1000 [00:11<00:22, 30.06it/s] 33%|███▎      | 333/1000 [00:11<00:22, 30.06it/s] 34%|███▎      | 337/1000 [00:11<00:22, 30.07it/s] 34%|███▍      | 341/1000 [00:11<00:21, 30.07it/s] 34%|███▍      | 345/1000 [00:12<00:21, 30.07it/s] 35%|███▍      | 349/1000 [00:12<00:21, 30.07it/s] 35%|███▌      | 353/1000 [00:12<00:21, 30.07it/s] 36%|███▌      | 357/1000 [00:12<00:21, 30.07it/s] 36%|███▌      | 361/1000 [00:12<00:21, 30.06it/s] 36%|███▋      | 365/1000 [00:12<00:21, 30.06it/s] 37%|███▋      | 369/1000 [00:12<00:20, 30.06it/s] 37%|███▋      | 373/1000 [00:13<00:20, 30.06it/s] 38%|███▊      | 377/1000 [00:13<00:20, 30.07it/s] 38%|███▊      | 381/1000 [00:13<00:20, 30.06it/s] 38%|███▊      | 385/1000 [00:13<00:20, 30.07it/s] 39%|███▉      | 389/1000 [00:13<00:20, 30.07it/s] 39%|███▉      | 393/1000 [00:13<00:20, 30.07it/s] 40%|███▉      | 397/1000 [00:13<00:20, 30.07it/s] 40%|████      | 401/1000 [00:13<00:19, 30.06it/s] 40%|████      | 405/1000 [00:14<00:19, 30.06it/s] 41%|████      | 409/1000 [00:14<00:19, 30.05it/s] 41%|████▏     | 413/1000 [00:14<00:19, 30.06it/s] 42%|████▏     | 417/1000 [00:14<00:19, 30.06it/s] 42%|████▏     | 421/1000 [00:14<00:19, 30.06it/s] 42%|████▎     | 425/1000 [00:14<00:19, 30.06it/s] 43%|████▎     | 429/1000 [00:14<00:18, 30.06it/s] 43%|████▎     | 433/1000 [00:15<00:18, 30.06it/s] 44%|████▎     | 437/1000 [00:15<00:18, 30.06it/s] 44%|████▍     | 441/1000 [00:15<00:18, 30.06it/s] 44%|████▍     | 445/1000 [00:15<00:18, 30.06it/s] 45%|████▍     | 449/1000 [00:15<00:18, 30.06it/s] 45%|████▌     | 453/1000 [00:15<00:18, 30.06it/s] 46%|████▌     | 457/1000 [00:15<00:18, 30.06it/s] 46%|████▌     | 461/1000 [00:15<00:17, 30.06it/s] 46%|████▋     | 465/1000 [00:16<00:17, 30.01it/s] 47%|████▋     | 469/1000 [00:16<00:17, 30.02it/s] 47%|████▋     | 473/1000 [00:16<00:17, 30.03it/s] 48%|████▊     | 477/1000 [00:16<00:17, 30.04it/s] 48%|████▊     | 481/1000 [00:16<00:17, 30.05it/s] 48%|████▊     | 485/1000 [00:16<00:17, 30.06it/s] 49%|████▉     | 489/1000 [00:16<00:16, 30.06it/s] 49%|████▉     | 493/1000 [00:17<00:16, 30.05it/s] 50%|████▉     | 497/1000 [00:17<00:16, 30.06it/s] 50%|█████     | 501/1000 [00:17<00:16, 30.06it/s] 50%|█████     | 505/1000 [00:17<00:16, 30.07it/s] 51%|█████     | 509/1000 [00:17<00:16, 30.07it/s] 51%|█████▏    | 513/1000 [00:17<00:16, 30.06it/s] 52%|█████▏    | 517/1000 [00:17<00:16, 30.06it/s] 52%|█████▏    | 521/1000 [00:17<00:15, 30.07it/s] 52%|█████▎    | 525/1000 [00:18<00:15, 30.08it/s] 53%|█████▎    | 529/1000 [00:18<00:15, 30.08it/s] 53%|█████▎    | 533/1000 [00:18<00:15, 30.08it/s] 54%|█████▎    | 537/1000 [00:18<00:15, 30.08it/s] 54%|█████▍    | 541/1000 [00:18<00:15, 30.08it/s] 55%|█████▍    | 545/1000 [00:18<00:15, 30.08it/s] 55%|█████▍    | 549/1000 [00:18<00:14, 30.08it/s] 55%|█████▌    | 553/1000 [00:19<00:14, 30.08it/s] 56%|█████▌    | 557/1000 [00:19<00:14, 30.08it/s] 56%|█████▌    | 561/1000 [00:19<00:14, 30.07it/s] 56%|█████▋    | 565/1000 [00:19<00:14, 30.07it/s] 57%|█████▋    | 569/1000 [00:19<00:14, 30.08it/s] 57%|█████▋    | 573/1000 [00:19<00:14, 30.08it/s] 58%|█████▊    | 577/1000 [00:19<00:14, 30.08it/s] 58%|█████▊    | 581/1000 [00:19<00:13, 30.08it/s] 58%|█████▊    | 585/1000 [00:20<00:13, 30.08it/s] 59%|█████▉    | 589/1000 [00:20<00:13, 30.08it/s] 59%|█████▉    | 593/1000 [00:20<00:13, 30.08it/s] 60%|█████▉    | 597/1000 [00:20<00:13, 30.08it/s] 60%|██████    | 601/1000 [00:20<00:13, 30.08it/s] 60%|██████    | 605/1000 [00:20<00:13, 30.08it/s] 61%|██████    | 609/1000 [00:20<00:12, 30.08it/s] 61%|██████▏   | 613/1000 [00:21<00:12, 30.08it/s] 62%|██████▏   | 617/1000 [00:21<00:12, 30.06it/s] 62%|██████▏   | 621/1000 [00:21<00:12, 30.07it/s] 62%|██████▎   | 625/1000 [00:21<00:12, 30.07it/s] 63%|██████▎   | 629/1000 [00:21<00:12, 30.07it/s] 63%|██████▎   | 633/1000 [00:21<00:12, 30.07it/s] 64%|██████▎   | 637/1000 [00:21<00:12, 30.08it/s] 64%|██████▍   | 641/1000 [00:21<00:11, 30.08it/s] 64%|██████▍   | 645/1000 [00:22<00:11, 30.08it/s] 65%|██████▍   | 649/1000 [00:22<00:11, 30.08it/s] 65%|██████▌   | 653/1000 [00:22<00:11, 30.08it/s] 66%|██████▌   | 657/1000 [00:22<00:11, 30.08it/s] 66%|██████▌   | 661/1000 [00:22<00:11, 30.08it/s] 66%|██████▋   | 665/1000 [00:22<00:11, 30.08it/s] 67%|██████▋   | 669/1000 [00:22<00:11, 30.08it/s] 67%|██████▋   | 673/1000 [00:23<00:10, 30.04it/s] 68%|██████▊   | 677/1000 [00:23<00:10, 30.04it/s] 68%|██████▊   | 681/1000 [00:23<00:10, 30.05it/s] 68%|██████▊   | 685/1000 [00:23<00:10, 30.06it/s] 69%|██████▉   | 689/1000 [00:23<00:10, 30.06it/s] 69%|██████▉   | 693/1000 [00:23<00:10, 30.07it/s] 70%|██████▉   | 697/1000 [00:23<00:10, 30.07it/s] 70%|███████   | 701/1000 [00:23<00:09, 30.07it/s] 70%|███████   | 705/1000 [00:24<00:09, 30.08it/s] 71%|███████   | 709/1000 [00:24<00:09, 30.08it/s] 71%|███████▏  | 713/1000 [00:24<00:09, 30.08it/s] 72%|███████▏  | 717/1000 [00:24<00:09, 30.08it/s] 72%|███████▏  | 721/1000 [00:24<00:09, 30.08it/s] 72%|███████▎  | 725/1000 [00:24<00:09, 30.07it/s] 73%|███████▎  | 729/1000 [00:24<00:09, 30.07it/s] 73%|███████▎  | 733/1000 [00:25<00:08, 30.06it/s] 74%|███████▎  | 737/1000 [00:25<00:08, 30.06it/s] 74%|███████▍  | 741/1000 [00:25<00:08, 30.07it/s] 74%|███████▍  | 745/1000 [00:25<00:08, 30.07it/s] 75%|███████▍  | 749/1000 [00:25<00:08, 30.07it/s] 75%|███████▌  | 753/1000 [00:25<00:08, 30.07it/s] 76%|███████▌  | 757/1000 [00:25<00:08, 30.08it/s] 76%|███████▌  | 761/1000 [00:25<00:07, 30.08it/s] 76%|███████▋  | 765/1000 [00:26<00:07, 30.07it/s] 77%|███████▋  | 769/1000 [00:26<00:07, 30.08it/s] 77%|███████▋  | 773/1000 [00:26<00:07, 30.08it/s] 78%|███████▊  | 777/1000 [00:26<00:07, 30.08it/s] 78%|███████▊  | 781/1000 [00:26<00:07, 30.08it/s] 78%|███████▊  | 785/1000 [00:26<00:07, 30.08it/s] 79%|███████▉  | 789/1000 [00:26<00:07, 30.07it/s] 79%|███████▉  | 793/1000 [00:27<00:06, 30.08it/s] 80%|███████▉  | 797/1000 [00:27<00:06, 30.08it/s] 80%|████████  | 801/1000 [00:27<00:06, 30.08it/s] 80%|████████  | 805/1000 [00:27<00:06, 30.08it/s] 81%|████████  | 809/1000 [00:27<00:06, 30.08it/s] 81%|████████▏ | 813/1000 [00:27<00:06, 30.08it/s] 82%|████████▏ | 817/1000 [00:27<00:06, 30.08it/s] 82%|████████▏ | 821/1000 [00:27<00:05, 30.08it/s] 82%|████████▎ | 825/1000 [00:28<00:05, 30.08it/s] 83%|████████▎ | 829/1000 [00:28<00:05, 30.08it/s] 83%|████████▎ | 833/1000 [00:28<00:05, 30.08it/s] 84%|████████▎ | 837/1000 [00:28<00:05, 30.08it/s] 84%|████████▍ | 841/1000 [00:28<00:05, 30.08it/s] 84%|████████▍ | 845/1000 [00:28<00:05, 30.08it/s] 85%|████████▍ | 849/1000 [00:28<00:05, 30.08it/s] 85%|████████▌ | 853/1000 [00:29<00:04, 30.08it/s] 86%|████████▌ | 857/1000 [00:29<00:04, 30.06it/s] 86%|████████▌ | 861/1000 [00:29<00:04, 30.06it/s] 86%|████████▋ | 865/1000 [00:29<00:04, 30.07it/s] 87%|████████▋ | 869/1000 [00:29<00:04, 30.07it/s] 87%|████████▋ | 873/1000 [00:29<00:04, 30.07it/s] 88%|████████▊ | 877/1000 [00:29<00:04, 30.07it/s] 88%|████████▊ | 881/1000 [00:29<00:03, 30.07it/s] 88%|████████▊ | 885/1000 [00:30<00:03, 30.07it/s] 89%|████████▉ | 889/1000 [00:30<00:03, 30.08it/s] 89%|████████▉ | 893/1000 [00:30<00:03, 30.08it/s] 90%|████████▉ | 897/1000 [00:30<00:03, 30.08it/s] 90%|█████████ | 901/1000 [00:30<00:03, 30.08it/s] 90%|█████████ | 905/1000 [00:30<00:03, 30.08it/s] 91%|█████████ | 909/1000 [00:30<00:03, 30.08it/s] 91%|█████████▏| 913/1000 [00:31<00:02, 30.08it/s] 92%|█████████▏| 917/1000 [00:31<00:02, 30.08it/s] 92%|█████████▏| 921/1000 [00:31<00:02, 30.08it/s] 92%|█████████▎| 925/1000 [00:31<00:02, 30.04it/s] 93%|█████████▎| 929/1000 [00:31<00:02, 30.04it/s] 93%|█████████▎| 933/1000 [00:31<00:02, 30.05it/s] 94%|█████████▎| 937/1000 [00:31<00:02, 30.06it/s] 94%|█████████▍| 941/1000 [00:31<00:01, 30.06it/s] 94%|█████████▍| 945/1000 [00:32<00:01, 30.07it/s] 95%|█████████▍| 949/1000 [00:32<00:01, 30.07it/s] 95%|█████████▌| 953/1000 [00:32<00:01, 30.07it/s] 96%|█████████▌| 957/1000 [00:32<00:01, 30.07it/s] 96%|█████████▌| 961/1000 [00:32<00:01, 30.08it/s] 96%|█████████▋| 965/1000 [00:32<00:01, 30.08it/s] 97%|█████████▋| 969/1000 [00:32<00:01, 30.08it/s] 97%|█████████▋| 973/1000 [00:32<00:00, 30.08it/s] 98%|█████████▊| 977/1000 [00:33<00:00, 30.08it/s] 98%|█████████▊| 981/1000 [00:33<00:00, 30.08it/s] 98%|█████████▊| 985/1000 [00:33<00:00, 30.08it/s] 99%|█████████▉| 989/1000 [00:33<00:00, 30.08it/s] 99%|█████████▉| 993/1000 [00:33<00:00, 30.06it/s]100%|█████████▉| 997/1000 [00:33<00:00, 30.06it/s]100%|██████████| 1000/1000 [00:33<00:00, 29.50it/s]
/gpfs/home6/scur1028/FairMI/train_bpr_fairmi.py:58: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3614.)
  neg_score[i] = torch.exp(torch.matmul(x_norm, z_norm[i].T) / tau).sum()
Traceback (most recent call last):
  File "/gpfs/home6/scur1028/FairMI/train_bpr_fairmi.py", line 216, in <module>
    train_unify_mi(sens_enc, inter_enc, club, dataset, u_sens, n_users, n_items, train_u2i, test_u2i, args)
  File "/gpfs/home6/scur1028/FairMI/train_bpr_fairmi.py", line 102, in train_unify_mi
    up = args.ureg * club.forward(e_zu[torch.unique(u)]) # Assuming CLUBSample.forward() is also adjusted
TypeError: forward() missing 1 required positional argument: 'y_samples'
Namespace(bakcbone='bpr', dataset='./data/ml-1m/process/process.pkl', emb_size=64, hidden_size=256, lr=0.001, l2_reg=0.001, n_layers=3, batch_size=2048, num_workers=6, log_path='logs/bpr_fairmi.txt', param_path='param/bpr_fairmi.pth', pretrain_path='param/bpr_base.pth', lreg=0.1, ureg=0.1, train_step=50, num_epochs=500, device='cuda:0')
epoch: 1000, classify_loss: 0.002425

JOB STATISTICS
==============
Job ID: 5018308
Cluster: snellius
User/Group: scur1028/scur1028
State: RUNNING
Nodes: 1
Cores per node: 18
CPU Utilized: 00:00:00
CPU Efficiency: 0.00% of 00:15:00 core-walltime
Job Wall-clock time: 00:00:50
Memory Utilized: 0.00 MB (estimated maximum)
Memory Efficiency: 0.00% of 60.00 GB (60.00 GB/node)
WARNING: Efficiency statistics may be misleading for RUNNING jobs.
