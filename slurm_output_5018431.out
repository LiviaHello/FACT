============================================================================================== 
Warning! Mixing Conda and module environments may lead to corruption of the
user environment. 
We do not recommend users mixing those two environments unless absolutely
necessary. Note that 
SURF does not provide any support for Conda environment.
For more information, please refer to our software policy page:
https://servicedesk.surf.nl/wiki/display/WIKI/Software+policy+Snellius+and+Lisa#SoftwarepolicySnelliusandLisa-UseofAnacondaandMinicondaenvironmentsonSnellius 

Remember that many packages have already been installed on the system and can
be loaded using 
the 'module load <package__name>' command. If you are uncertain if a package is
already available 
on the system, please use 'module avail' or 'module spider' to search for it.
============================================================================================== 
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<10:51,  1.53it/s]  0%|          | 4/1000 [00:00<02:30,  6.64it/s]  1%|          | 8/1000 [00:00<01:18, 12.59it/s]  1%|          | 12/1000 [00:01<00:57, 17.25it/s]  2%|▏         | 16/1000 [00:01<00:47, 20.78it/s]  2%|▏         | 20/1000 [00:01<00:41, 23.41it/s]  2%|▏         | 24/1000 [00:01<00:38, 25.32it/s]  3%|▎         | 28/1000 [00:01<00:36, 26.70it/s]  3%|▎         | 32/1000 [00:01<00:34, 27.69it/s]  4%|▎         | 36/1000 [00:01<00:33, 28.40it/s]  4%|▍         | 40/1000 [00:01<00:33, 28.89it/s]  4%|▍         | 44/1000 [00:02<00:32, 29.25it/s]  5%|▍         | 48/1000 [00:02<00:32, 29.49it/s]  5%|▌         | 52/1000 [00:02<00:31, 29.67it/s]  6%|▌         | 56/1000 [00:02<00:31, 29.79it/s]  6%|▌         | 60/1000 [00:02<00:31, 29.80it/s]  6%|▋         | 64/1000 [00:02<00:31, 29.88it/s]  7%|▋         | 68/1000 [00:02<00:31, 29.94it/s]  7%|▋         | 72/1000 [00:03<00:30, 29.98it/s]  8%|▊         | 76/1000 [00:03<00:30, 30.01it/s]  8%|▊         | 80/1000 [00:03<00:30, 30.03it/s]  8%|▊         | 84/1000 [00:03<00:30, 30.05it/s]  9%|▉         | 88/1000 [00:03<00:30, 30.06it/s]  9%|▉         | 92/1000 [00:03<00:30, 29.87it/s] 10%|▉         | 96/1000 [00:03<00:30, 29.92it/s] 10%|█         | 100/1000 [00:03<00:30, 29.97it/s] 10%|█         | 104/1000 [00:04<00:29, 30.00it/s] 11%|█         | 108/1000 [00:04<00:29, 30.03it/s] 11%|█         | 112/1000 [00:04<00:29, 30.04it/s] 12%|█▏        | 116/1000 [00:04<00:29, 30.05it/s] 12%|█▏        | 120/1000 [00:04<00:29, 30.06it/s] 12%|█▏        | 124/1000 [00:04<00:29, 30.06it/s] 13%|█▎        | 128/1000 [00:04<00:29, 30.05it/s] 13%|█▎        | 132/1000 [00:05<00:28, 30.05it/s] 14%|█▎        | 136/1000 [00:05<00:28, 30.06it/s] 14%|█▍        | 140/1000 [00:05<00:28, 30.07it/s] 14%|█▍        | 144/1000 [00:05<00:28, 30.07it/s] 15%|█▍        | 148/1000 [00:05<00:28, 30.07it/s] 15%|█▌        | 152/1000 [00:05<00:28, 30.07it/s] 16%|█▌        | 156/1000 [00:05<00:28, 30.07it/s] 16%|█▌        | 160/1000 [00:05<00:27, 30.07it/s] 16%|█▋        | 164/1000 [00:06<00:27, 30.07it/s] 17%|█▋        | 168/1000 [00:06<00:27, 30.07it/s] 17%|█▋        | 172/1000 [00:06<00:27, 30.07it/s] 18%|█▊        | 176/1000 [00:06<00:27, 30.08it/s] 18%|█▊        | 180/1000 [00:06<00:27, 30.08it/s] 18%|█▊        | 184/1000 [00:06<00:27, 30.08it/s] 19%|█▉        | 188/1000 [00:06<00:26, 30.08it/s] 19%|█▉        | 192/1000 [00:07<00:26, 30.06it/s] 20%|█▉        | 196/1000 [00:07<00:26, 30.06it/s] 20%|██        | 200/1000 [00:07<00:26, 30.07it/s] 20%|██        | 204/1000 [00:07<00:26, 30.07it/s] 21%|██        | 208/1000 [00:07<00:26, 30.07it/s] 21%|██        | 212/1000 [00:07<00:26, 30.07it/s] 22%|██▏       | 216/1000 [00:07<00:26, 30.07it/s] 22%|██▏       | 220/1000 [00:07<00:25, 30.07it/s] 22%|██▏       | 224/1000 [00:08<00:25, 30.07it/s] 23%|██▎       | 228/1000 [00:08<00:25, 30.00it/s] 23%|██▎       | 232/1000 [00:08<00:25, 30.03it/s] 24%|██▎       | 236/1000 [00:08<00:25, 30.04it/s] 24%|██▍       | 240/1000 [00:08<00:25, 30.05it/s] 24%|██▍       | 244/1000 [00:08<00:25, 30.06it/s] 25%|██▍       | 248/1000 [00:08<00:25, 30.06it/s] 25%|██▌       | 252/1000 [00:09<00:24, 30.07it/s] 26%|██▌       | 256/1000 [00:09<00:24, 30.07it/s] 26%|██▌       | 260/1000 [00:09<00:24, 30.07it/s] 26%|██▋       | 264/1000 [00:09<00:24, 30.08it/s] 27%|██▋       | 268/1000 [00:09<00:24, 30.07it/s] 27%|██▋       | 272/1000 [00:09<00:24, 30.07it/s] 28%|██▊       | 276/1000 [00:09<00:24, 30.08it/s] 28%|██▊       | 280/1000 [00:09<00:23, 30.04it/s] 28%|██▊       | 284/1000 [00:10<00:23, 30.04it/s] 29%|██▉       | 288/1000 [00:10<00:23, 30.06it/s] 29%|██▉       | 292/1000 [00:10<00:23, 30.06it/s] 30%|██▉       | 296/1000 [00:10<00:23, 30.07it/s] 30%|███       | 300/1000 [00:10<00:23, 30.07it/s] 30%|███       | 304/1000 [00:10<00:23, 30.07it/s] 31%|███       | 308/1000 [00:10<00:23, 30.07it/s] 31%|███       | 312/1000 [00:11<00:22, 30.07it/s] 32%|███▏      | 316/1000 [00:11<00:22, 30.07it/s] 32%|███▏      | 320/1000 [00:11<00:22, 30.08it/s] 32%|███▏      | 324/1000 [00:11<00:22, 30.08it/s] 33%|███▎      | 328/1000 [00:11<00:22, 30.08it/s] 33%|███▎      | 332/1000 [00:11<00:22, 30.08it/s] 34%|███▎      | 336/1000 [00:11<00:22, 30.08it/s] 34%|███▍      | 340/1000 [00:11<00:21, 30.08it/s] 34%|███▍      | 344/1000 [00:12<00:21, 30.08it/s] 35%|███▍      | 348/1000 [00:12<00:21, 30.08it/s] 35%|███▌      | 352/1000 [00:12<00:21, 30.08it/s] 36%|███▌      | 356/1000 [00:12<00:21, 30.08it/s] 36%|███▌      | 360/1000 [00:12<00:21, 30.06it/s] 36%|███▋      | 364/1000 [00:12<00:21, 30.06it/s] 37%|███▋      | 368/1000 [00:12<00:21, 30.07it/s] 37%|███▋      | 372/1000 [00:12<00:20, 30.07it/s] 38%|███▊      | 376/1000 [00:13<00:20, 30.07it/s] 38%|███▊      | 380/1000 [00:13<00:20, 30.08it/s] 38%|███▊      | 384/1000 [00:13<00:20, 30.08it/s] 39%|███▉      | 388/1000 [00:13<00:20, 30.08it/s] 39%|███▉      | 392/1000 [00:13<00:20, 30.08it/s] 40%|███▉      | 396/1000 [00:13<00:20, 30.08it/s] 40%|████      | 400/1000 [00:13<00:19, 30.08it/s] 40%|████      | 404/1000 [00:14<00:19, 30.08it/s] 41%|████      | 408/1000 [00:14<00:19, 30.08it/s] 41%|████      | 412/1000 [00:14<00:19, 30.08it/s] 42%|████▏     | 416/1000 [00:14<00:19, 30.08it/s] 42%|████▏     | 420/1000 [00:14<00:19, 30.08it/s] 42%|████▏     | 424/1000 [00:14<00:19, 30.08it/s] 43%|████▎     | 428/1000 [00:14<00:19, 30.08it/s] 43%|████▎     | 432/1000 [00:14<00:18, 30.08it/s] 44%|████▎     | 436/1000 [00:15<00:18, 30.08it/s] 44%|████▍     | 440/1000 [00:15<00:18, 30.08it/s] 44%|████▍     | 444/1000 [00:15<00:18, 30.08it/s] 45%|████▍     | 448/1000 [00:15<00:18, 30.07it/s] 45%|████▌     | 452/1000 [00:15<00:18, 30.07it/s] 46%|████▌     | 456/1000 [00:15<00:18, 30.07it/s] 46%|████▌     | 460/1000 [00:15<00:17, 30.08it/s] 46%|████▋     | 464/1000 [00:16<00:17, 30.08it/s] 47%|████▋     | 468/1000 [00:16<00:17, 30.08it/s] 47%|████▋     | 472/1000 [00:16<00:17, 30.08it/s] 48%|████▊     | 476/1000 [00:16<00:17, 30.08it/s] 48%|████▊     | 480/1000 [00:16<00:17, 30.07it/s] 48%|████▊     | 484/1000 [00:16<00:17, 30.05it/s] 49%|████▉     | 488/1000 [00:16<00:17, 30.06it/s] 49%|████▉     | 492/1000 [00:16<00:16, 30.07it/s] 50%|████▉     | 496/1000 [00:17<00:16, 30.07it/s] 50%|█████     | 500/1000 [00:17<00:16, 30.07it/s] 50%|█████     | 504/1000 [00:17<00:16, 30.07it/s] 51%|█████     | 508/1000 [00:17<00:16, 30.08it/s] 51%|█████     | 512/1000 [00:17<00:16, 30.08it/s] 52%|█████▏    | 516/1000 [00:17<00:16, 30.08it/s] 52%|█████▏    | 520/1000 [00:17<00:15, 30.08it/s] 52%|█████▏    | 524/1000 [00:18<00:15, 30.08it/s] 53%|█████▎    | 528/1000 [00:18<00:15, 30.07it/s] 53%|█████▎    | 532/1000 [00:18<00:15, 30.07it/s] 54%|█████▎    | 536/1000 [00:18<00:15, 30.07it/s] 54%|█████▍    | 540/1000 [00:18<00:15, 30.08it/s] 54%|█████▍    | 544/1000 [00:18<00:15, 30.08it/s] 55%|█████▍    | 548/1000 [00:18<00:15, 30.08it/s] 55%|█████▌    | 552/1000 [00:18<00:14, 30.08it/s] 56%|█████▌    | 556/1000 [00:19<00:14, 30.08it/s] 56%|█████▌    | 560/1000 [00:19<00:14, 30.08it/s] 56%|█████▋    | 564/1000 [00:19<00:14, 30.08it/s] 57%|█████▋    | 568/1000 [00:19<00:14, 30.08it/s] 57%|█████▋    | 572/1000 [00:19<00:14, 30.08it/s] 58%|█████▊    | 576/1000 [00:19<00:14, 30.08it/s] 58%|█████▊    | 580/1000 [00:19<00:13, 30.08it/s] 58%|█████▊    | 584/1000 [00:20<00:13, 30.08it/s] 59%|█████▉    | 588/1000 [00:20<00:13, 30.06it/s] 59%|█████▉    | 592/1000 [00:20<00:13, 30.06it/s] 60%|█████▉    | 596/1000 [00:20<00:13, 30.07it/s] 60%|██████    | 600/1000 [00:20<00:13, 30.07it/s] 60%|██████    | 604/1000 [00:20<00:13, 30.08it/s] 61%|██████    | 608/1000 [00:20<00:13, 30.07it/s] 61%|██████    | 612/1000 [00:20<00:12, 30.07it/s] 62%|██████▏   | 616/1000 [00:21<00:12, 30.08it/s] 62%|██████▏   | 620/1000 [00:21<00:12, 30.08it/s] 62%|██████▏   | 624/1000 [00:21<00:12, 30.07it/s] 63%|██████▎   | 628/1000 [00:21<00:12, 30.08it/s] 63%|██████▎   | 632/1000 [00:21<00:12, 30.08it/s] 64%|██████▎   | 636/1000 [00:21<00:12, 30.08it/s] 64%|██████▍   | 640/1000 [00:21<00:11, 30.08it/s] 64%|██████▍   | 644/1000 [00:22<00:11, 30.08it/s] 65%|██████▍   | 648/1000 [00:22<00:11, 30.08it/s] 65%|██████▌   | 652/1000 [00:22<00:11, 30.08it/s] 66%|██████▌   | 656/1000 [00:22<00:11, 30.08it/s] 66%|██████▌   | 660/1000 [00:22<00:11, 30.08it/s] 66%|██████▋   | 664/1000 [00:22<00:11, 30.08it/s] 67%|██████▋   | 668/1000 [00:22<00:11, 30.08it/s] 67%|██████▋   | 672/1000 [00:22<00:10, 30.08it/s] 68%|██████▊   | 676/1000 [00:23<00:10, 30.08it/s] 68%|██████▊   | 680/1000 [00:23<00:10, 30.08it/s] 68%|██████▊   | 684/1000 [00:23<00:10, 30.08it/s] 69%|██████▉   | 688/1000 [00:23<00:10, 30.08it/s] 69%|██████▉   | 692/1000 [00:23<00:10, 30.06it/s] 70%|██████▉   | 696/1000 [00:23<00:10, 30.07it/s] 70%|███████   | 700/1000 [00:23<00:09, 30.07it/s] 70%|███████   | 704/1000 [00:24<00:09, 30.07it/s] 71%|███████   | 708/1000 [00:24<00:09, 30.07it/s] 71%|███████   | 712/1000 [00:24<00:09, 30.08it/s] 72%|███████▏  | 716/1000 [00:24<00:09, 30.08it/s] 72%|███████▏  | 720/1000 [00:24<00:09, 30.07it/s] 72%|███████▏  | 724/1000 [00:24<00:09, 30.07it/s] 73%|███████▎  | 728/1000 [00:24<00:09, 30.08it/s] 73%|███████▎  | 732/1000 [00:24<00:08, 30.07it/s] 74%|███████▎  | 736/1000 [00:25<00:08, 30.07it/s] 74%|███████▍  | 740/1000 [00:25<00:08, 30.08it/s] 74%|███████▍  | 744/1000 [00:25<00:08, 30.08it/s] 75%|███████▍  | 748/1000 [00:25<00:08, 30.08it/s] 75%|███████▌  | 752/1000 [00:25<00:08, 30.01it/s] 76%|███████▌  | 756/1000 [00:25<00:08, 30.03it/s] 76%|███████▌  | 760/1000 [00:25<00:07, 30.04it/s] 76%|███████▋  | 764/1000 [00:26<00:07, 30.05it/s] 77%|███████▋  | 768/1000 [00:26<00:07, 30.06it/s] 77%|███████▋  | 772/1000 [00:26<00:07, 30.07it/s] 78%|███████▊  | 776/1000 [00:26<00:07, 30.07it/s] 78%|███████▊  | 780/1000 [00:26<00:07, 30.08it/s] 78%|███████▊  | 784/1000 [00:26<00:07, 30.07it/s] 79%|███████▉  | 788/1000 [00:26<00:07, 30.07it/s] 79%|███████▉  | 792/1000 [00:26<00:06, 30.08it/s] 80%|███████▉  | 796/1000 [00:27<00:06, 30.08it/s] 80%|████████  | 800/1000 [00:27<00:06, 30.08it/s] 80%|████████  | 804/1000 [00:27<00:06, 30.08it/s] 81%|████████  | 808/1000 [00:27<00:06, 30.06it/s] 81%|████████  | 812/1000 [00:27<00:06, 30.06it/s] 82%|████████▏ | 816/1000 [00:27<00:06, 30.07it/s] 82%|████████▏ | 820/1000 [00:27<00:05, 30.07it/s] 82%|████████▏ | 824/1000 [00:28<00:05, 30.07it/s] 83%|████████▎ | 828/1000 [00:28<00:05, 30.07it/s] 83%|████████▎ | 832/1000 [00:28<00:05, 30.07it/s] 84%|████████▎ | 836/1000 [00:28<00:05, 30.08it/s] 84%|████████▍ | 840/1000 [00:28<00:05, 30.08it/s] 84%|████████▍ | 844/1000 [00:28<00:05, 30.08it/s] 85%|████████▍ | 848/1000 [00:28<00:05, 30.08it/s] 85%|████████▌ | 852/1000 [00:28<00:04, 30.08it/s] 86%|████████▌ | 856/1000 [00:29<00:04, 30.08it/s] 86%|████████▌ | 860/1000 [00:29<00:04, 30.08it/s] 86%|████████▋ | 864/1000 [00:29<00:04, 30.08it/s] 87%|████████▋ | 868/1000 [00:29<00:04, 30.08it/s] 87%|████████▋ | 872/1000 [00:29<00:04, 30.08it/s] 88%|████████▊ | 876/1000 [00:29<00:04, 30.08it/s] 88%|████████▊ | 880/1000 [00:29<00:03, 30.08it/s] 88%|████████▊ | 884/1000 [00:30<00:03, 30.08it/s] 89%|████████▉ | 888/1000 [00:30<00:03, 30.08it/s] 89%|████████▉ | 892/1000 [00:30<00:03, 30.08it/s] 90%|████████▉ | 896/1000 [00:30<00:03, 30.08it/s] 90%|█████████ | 900/1000 [00:30<00:03, 30.08it/s] 90%|█████████ | 904/1000 [00:30<00:03, 30.08it/s] 91%|█████████ | 908/1000 [00:30<00:03, 30.08it/s] 91%|█████████ | 912/1000 [00:30<00:02, 30.08it/s] 92%|█████████▏| 916/1000 [00:31<00:02, 30.08it/s] 92%|█████████▏| 920/1000 [00:31<00:02, 30.08it/s] 92%|█████████▏| 924/1000 [00:31<00:02, 30.08it/s] 93%|█████████▎| 928/1000 [00:31<00:02, 30.08it/s] 93%|█████████▎| 932/1000 [00:31<00:02, 30.08it/s] 94%|█████████▎| 936/1000 [00:31<00:02, 30.08it/s] 94%|█████████▍| 940/1000 [00:31<00:01, 30.08it/s] 94%|█████████▍| 944/1000 [00:32<00:01, 30.08it/s] 95%|█████████▍| 948/1000 [00:32<00:01, 30.08it/s] 95%|█████████▌| 952/1000 [00:32<00:01, 30.08it/s] 96%|█████████▌| 956/1000 [00:32<00:01, 30.06it/s] 96%|█████████▌| 960/1000 [00:32<00:01, 30.07it/s] 96%|█████████▋| 964/1000 [00:32<00:01, 30.07it/s] 97%|█████████▋| 968/1000 [00:32<00:01, 30.07it/s] 97%|█████████▋| 972/1000 [00:32<00:00, 30.08it/s] 98%|█████████▊| 976/1000 [00:33<00:00, 30.07it/s] 98%|█████████▊| 980/1000 [00:33<00:00, 30.08it/s] 98%|█████████▊| 984/1000 [00:33<00:00, 30.08it/s] 99%|█████████▉| 988/1000 [00:33<00:00, 30.08it/s] 99%|█████████▉| 992/1000 [00:33<00:00, 30.08it/s]100%|█████████▉| 996/1000 [00:33<00:00, 30.08it/s]100%|██████████| 1000/1000 [00:33<00:00, 30.08it/s]100%|██████████| 1000/1000 [00:33<00:00, 29.52it/s]
Traceback (most recent call last):
  File "/gpfs/home6/scur1028/FairMI/train_bpr_fairmi.py", line 224, in <module>
    train_unify_mi(sens_enc, inter_enc, club, dataset, u_sens, n_users, n_items, train_u2i, test_u2i, args)
  File "/gpfs/home6/scur1028/FairMI/train_bpr_fairmi.py", line 107, in train_unify_mi
    lb2 = condition_info_nce_for_embeddings_fairmi_star(e_xi[torch.unique(i)], e_zi[torch.unique(i)])
  File "/gpfs/home6/scur1028/FairMI/train_bpr_fairmi.py", line 56, in condition_info_nce_for_embeddings_fairmi_star
    neg_score[i] = torch.exp(torch.matmul(x_norm, z_norm.T) / tau).sum() - pos_score[i]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacty of 19.50 GiB of which 3.88 MiB is free. Including non-PyTorch memory, this process has 19.45 GiB memory in use. Of the allocated memory 17.52 GiB is allocated by PyTorch, and 1.71 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Namespace(bakcbone='bpr', dataset='./data/ml-1m/process/process.pkl', emb_size=64, hidden_size=256, lr=0.001, l2_reg=0.001, n_layers=3, batch_size=2048, num_workers=6, log_path='logs/bpr_fairmi.txt', param_path='param/bpr_fairmi.pth', pretrain_path='param/bpr_base.pth', lreg=0.1, ureg=0.1, train_step=50, num_epochs=500, device='cuda:0')
epoch: 1000, classify_loss: 0.002457

JOB STATISTICS
==============
Job ID: 5018431
Cluster: snellius
User/Group: scur1028/scur1028
State: RUNNING
Nodes: 1
Cores per node: 18
CPU Utilized: 00:00:00
CPU Efficiency: 0.00% of 00:14:42 core-walltime
Job Wall-clock time: 00:00:49
Memory Utilized: 0.00 MB (estimated maximum)
Memory Efficiency: 0.00% of 60.00 GB (60.00 GB/node)
WARNING: Efficiency statistics may be misleading for RUNNING jobs.
