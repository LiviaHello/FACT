============================================================================================== 
Warning! Mixing Conda and module environments may lead to corruption of the
user environment. 
We do not recommend users mixing those two environments unless absolutely
necessary. Note that 
SURF does not provide any support for Conda environment.
For more information, please refer to our software policy page:
https://servicedesk.surf.nl/wiki/display/WIKI/Software+policy+Snellius+and+Lisa#SoftwarepolicySnelliusandLisa-UseofAnacondaandMinicondaenvironmentsonSnellius 

Remember that many packages have already been installed on the system and can
be loaded using 
the 'module load <package__name>' command. If you are uncertain if a package is
already available 
on the system, please use 'module avail' or 'module spider' to search for it.
============================================================================================== 
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<11:10,  1.49it/s]  0%|          | 4/1000 [00:00<02:33,  6.49it/s]  1%|          | 8/1000 [00:00<01:20, 12.38it/s]  1%|          | 12/1000 [00:01<00:58, 17.03it/s]  2%|▏         | 16/1000 [00:01<00:47, 20.59it/s]  2%|▏         | 20/1000 [00:01<00:42, 23.25it/s]  2%|▏         | 24/1000 [00:01<00:38, 25.20it/s]  3%|▎         | 28/1000 [00:01<00:36, 26.60it/s]  3%|▎         | 32/1000 [00:01<00:35, 27.61it/s]  4%|▎         | 36/1000 [00:01<00:34, 28.33it/s]  4%|▍         | 40/1000 [00:01<00:33, 28.85it/s]  4%|▍         | 44/1000 [00:02<00:32, 29.21it/s]  5%|▍         | 48/1000 [00:02<00:32, 29.47it/s]  5%|▌         | 52/1000 [00:02<00:31, 29.65it/s]  6%|▌         | 56/1000 [00:02<00:31, 29.78it/s]  6%|▌         | 60/1000 [00:02<00:31, 29.79it/s]  6%|▋         | 63/1000 [00:02<00:31, 29.81it/s]  7%|▋         | 67/1000 [00:02<00:31, 29.89it/s]  7%|▋         | 71/1000 [00:03<00:31, 29.94it/s]  8%|▊         | 75/1000 [00:03<00:30, 29.98it/s]  8%|▊         | 79/1000 [00:03<00:30, 30.01it/s]  8%|▊         | 83/1000 [00:03<00:30, 30.03it/s]  9%|▊         | 87/1000 [00:03<00:30, 30.04it/s]  9%|▉         | 91/1000 [00:03<00:30, 30.05it/s] 10%|▉         | 95/1000 [00:03<00:30, 30.06it/s] 10%|▉         | 99/1000 [00:03<00:29, 30.04it/s] 10%|█         | 103/1000 [00:04<00:29, 30.05it/s] 11%|█         | 107/1000 [00:04<00:29, 30.06it/s] 11%|█         | 111/1000 [00:04<00:29, 30.06it/s] 12%|█▏        | 115/1000 [00:04<00:29, 30.07it/s] 12%|█▏        | 119/1000 [00:04<00:29, 30.01it/s] 12%|█▏        | 123/1000 [00:04<00:29, 30.03it/s] 13%|█▎        | 127/1000 [00:04<00:29, 30.04it/s] 13%|█▎        | 131/1000 [00:04<00:28, 30.05it/s] 14%|█▎        | 135/1000 [00:05<00:28, 30.06it/s] 14%|█▍        | 139/1000 [00:05<00:28, 30.06it/s] 14%|█▍        | 143/1000 [00:05<00:28, 30.07it/s] 15%|█▍        | 147/1000 [00:05<00:28, 30.07it/s] 15%|█▌        | 151/1000 [00:05<00:28, 30.07it/s] 16%|█▌        | 155/1000 [00:05<00:28, 30.07it/s] 16%|█▌        | 159/1000 [00:05<00:27, 30.07it/s] 16%|█▋        | 163/1000 [00:06<00:27, 30.07it/s] 17%|█▋        | 167/1000 [00:06<00:27, 30.07it/s] 17%|█▋        | 171/1000 [00:06<00:27, 30.07it/s] 18%|█▊        | 175/1000 [00:06<00:27, 30.07it/s] 18%|█▊        | 179/1000 [00:06<00:27, 30.04it/s] 18%|█▊        | 183/1000 [00:06<00:27, 30.05it/s] 19%|█▊        | 187/1000 [00:06<00:27, 30.06it/s] 19%|█▉        | 191/1000 [00:06<00:26, 30.06it/s] 20%|█▉        | 195/1000 [00:07<00:26, 30.06it/s] 20%|█▉        | 199/1000 [00:07<00:26, 30.07it/s] 20%|██        | 203/1000 [00:07<00:26, 30.07it/s] 21%|██        | 207/1000 [00:07<00:26, 30.06it/s] 21%|██        | 211/1000 [00:07<00:26, 30.03it/s] 22%|██▏       | 215/1000 [00:07<00:26, 30.05it/s] 22%|██▏       | 219/1000 [00:07<00:25, 30.05it/s] 22%|██▏       | 223/1000 [00:08<00:25, 30.06it/s] 23%|██▎       | 227/1000 [00:08<00:25, 30.00it/s] 23%|██▎       | 231/1000 [00:08<00:25, 30.02it/s] 24%|██▎       | 235/1000 [00:08<00:25, 30.04it/s] 24%|██▍       | 239/1000 [00:08<00:25, 30.05it/s] 24%|██▍       | 243/1000 [00:08<00:25, 30.06it/s] 25%|██▍       | 247/1000 [00:08<00:25, 30.06it/s] 25%|██▌       | 251/1000 [00:08<00:24, 30.07it/s] 26%|██▌       | 255/1000 [00:09<00:24, 30.05it/s] 26%|██▌       | 259/1000 [00:09<00:24, 30.06it/s] 26%|██▋       | 263/1000 [00:09<00:24, 30.06it/s] 27%|██▋       | 267/1000 [00:09<00:24, 30.07it/s] 27%|██▋       | 271/1000 [00:09<00:24, 30.07it/s] 28%|██▊       | 275/1000 [00:09<00:24, 30.07it/s] 28%|██▊       | 279/1000 [00:09<00:23, 30.07it/s] 28%|██▊       | 283/1000 [00:10<00:23, 30.07it/s] 29%|██▊       | 287/1000 [00:10<00:23, 30.07it/s] 29%|██▉       | 291/1000 [00:10<00:23, 30.07it/s] 30%|██▉       | 295/1000 [00:10<00:23, 30.07it/s] 30%|██▉       | 299/1000 [00:10<00:23, 30.07it/s] 30%|███       | 303/1000 [00:10<00:23, 30.07it/s] 31%|███       | 307/1000 [00:10<00:23, 30.06it/s] 31%|███       | 311/1000 [00:10<00:22, 30.06it/s] 32%|███▏      | 315/1000 [00:11<00:22, 30.06it/s] 32%|███▏      | 319/1000 [00:11<00:22, 30.06it/s] 32%|███▏      | 323/1000 [00:11<00:22, 30.06it/s] 33%|███▎      | 327/1000 [00:11<00:22, 30.06it/s] 33%|███▎      | 331/1000 [00:11<00:22, 30.06it/s] 34%|███▎      | 335/1000 [00:11<00:22, 30.07it/s] 34%|███▍      | 339/1000 [00:11<00:21, 30.07it/s] 34%|███▍      | 343/1000 [00:12<00:21, 30.06it/s] 35%|███▍      | 347/1000 [00:12<00:21, 30.07it/s] 35%|███▌      | 351/1000 [00:12<00:21, 30.07it/s] 36%|███▌      | 355/1000 [00:12<00:21, 30.07it/s] 36%|███▌      | 359/1000 [00:12<00:21, 30.06it/s] 36%|███▋      | 363/1000 [00:12<00:21, 30.07it/s] 37%|███▋      | 367/1000 [00:12<00:21, 30.07it/s] 37%|███▋      | 371/1000 [00:12<00:20, 30.07it/s] 38%|███▊      | 375/1000 [00:13<00:20, 30.07it/s] 38%|███▊      | 379/1000 [00:13<00:20, 30.07it/s] 38%|███▊      | 383/1000 [00:13<00:20, 30.07it/s] 39%|███▊      | 387/1000 [00:13<00:20, 30.07it/s] 39%|███▉      | 391/1000 [00:13<00:20, 30.07it/s] 40%|███▉      | 395/1000 [00:13<00:20, 30.07it/s] 40%|███▉      | 399/1000 [00:13<00:19, 30.07it/s] 40%|████      | 403/1000 [00:14<00:19, 30.07it/s] 41%|████      | 407/1000 [00:14<00:19, 30.07it/s] 41%|████      | 411/1000 [00:14<00:19, 30.07it/s] 42%|████▏     | 415/1000 [00:14<00:19, 30.05it/s] 42%|████▏     | 419/1000 [00:14<00:19, 30.05it/s] 42%|████▏     | 423/1000 [00:14<00:19, 30.06it/s] 43%|████▎     | 427/1000 [00:14<00:19, 30.06it/s] 43%|████▎     | 431/1000 [00:14<00:18, 30.06it/s] 44%|████▎     | 435/1000 [00:15<00:18, 30.07it/s] 44%|████▍     | 439/1000 [00:15<00:18, 30.07it/s] 44%|████▍     | 443/1000 [00:15<00:18, 30.07it/s] 45%|████▍     | 447/1000 [00:15<00:18, 30.07it/s] 45%|████▌     | 451/1000 [00:15<00:18, 30.07it/s] 46%|████▌     | 455/1000 [00:15<00:18, 30.08it/s] 46%|████▌     | 459/1000 [00:15<00:17, 30.07it/s] 46%|████▋     | 463/1000 [00:16<00:17, 30.08it/s] 47%|████▋     | 467/1000 [00:16<00:17, 30.07it/s] 47%|████▋     | 471/1000 [00:16<00:17, 30.03it/s] 48%|████▊     | 475/1000 [00:16<00:17, 30.04it/s] 48%|████▊     | 479/1000 [00:16<00:17, 30.05it/s] 48%|████▊     | 483/1000 [00:16<00:17, 30.05it/s] 49%|████▊     | 487/1000 [00:16<00:17, 30.06it/s] 49%|████▉     | 491/1000 [00:16<00:16, 30.06it/s] 50%|████▉     | 495/1000 [00:17<00:16, 30.06it/s] 50%|████▉     | 499/1000 [00:17<00:16, 30.06it/s] 50%|█████     | 503/1000 [00:17<00:16, 30.07it/s] 51%|█████     | 507/1000 [00:17<00:16, 30.07it/s] 51%|█████     | 511/1000 [00:17<00:16, 30.07it/s] 52%|█████▏    | 515/1000 [00:17<00:16, 30.08it/s] 52%|█████▏    | 519/1000 [00:17<00:16, 30.06it/s] 52%|█████▏    | 523/1000 [00:18<00:15, 30.06it/s] 53%|█████▎    | 527/1000 [00:18<00:15, 30.07it/s] 53%|█████▎    | 531/1000 [00:18<00:15, 30.07it/s] 54%|█████▎    | 535/1000 [00:18<00:15, 30.07it/s] 54%|█████▍    | 539/1000 [00:18<00:15, 30.07it/s] 54%|█████▍    | 543/1000 [00:18<00:15, 30.08it/s] 55%|█████▍    | 547/1000 [00:18<00:15, 30.08it/s] 55%|█████▌    | 551/1000 [00:18<00:14, 30.08it/s] 56%|█████▌    | 555/1000 [00:19<00:14, 30.08it/s] 56%|█████▌    | 559/1000 [00:19<00:14, 30.08it/s] 56%|█████▋    | 563/1000 [00:19<00:14, 30.08it/s] 57%|█████▋    | 567/1000 [00:19<00:14, 30.07it/s] 57%|█████▋    | 571/1000 [00:19<00:14, 30.07it/s] 57%|█████▊    | 575/1000 [00:19<00:14, 30.07it/s] 58%|█████▊    | 579/1000 [00:19<00:13, 30.07it/s] 58%|█████▊    | 583/1000 [00:20<00:13, 30.07it/s] 59%|█████▊    | 587/1000 [00:20<00:13, 30.07it/s] 59%|█████▉    | 591/1000 [00:20<00:13, 30.07it/s] 60%|█████▉    | 595/1000 [00:20<00:13, 30.08it/s] 60%|█████▉    | 599/1000 [00:20<00:13, 30.08it/s] 60%|██████    | 603/1000 [00:20<00:13, 30.08it/s] 61%|██████    | 607/1000 [00:20<00:13, 30.08it/s] 61%|██████    | 611/1000 [00:20<00:12, 30.08it/s] 62%|██████▏   | 615/1000 [00:21<00:12, 30.09it/s] 62%|██████▏   | 619/1000 [00:21<00:12, 30.09it/s] 62%|██████▏   | 623/1000 [00:21<00:12, 30.09it/s] 63%|██████▎   | 627/1000 [00:21<00:12, 30.07it/s] 63%|██████▎   | 631/1000 [00:21<00:12, 30.07it/s] 64%|██████▎   | 635/1000 [00:21<00:12, 30.08it/s] 64%|██████▍   | 639/1000 [00:21<00:12, 30.08it/s] 64%|██████▍   | 643/1000 [00:22<00:11, 30.08it/s] 65%|██████▍   | 647/1000 [00:22<00:11, 30.08it/s] 65%|██████▌   | 651/1000 [00:22<00:11, 30.08it/s] 66%|██████▌   | 655/1000 [00:22<00:11, 30.08it/s] 66%|██████▌   | 659/1000 [00:22<00:11, 30.08it/s] 66%|██████▋   | 663/1000 [00:22<00:11, 30.08it/s] 67%|██████▋   | 667/1000 [00:22<00:11, 30.08it/s] 67%|██████▋   | 671/1000 [00:22<00:10, 30.08it/s] 68%|██████▊   | 675/1000 [00:23<00:10, 30.08it/s] 68%|██████▊   | 679/1000 [00:23<00:10, 30.09it/s] 68%|██████▊   | 683/1000 [00:23<00:10, 30.06it/s] 69%|██████▊   | 687/1000 [00:23<00:10, 30.06it/s] 69%|██████▉   | 691/1000 [00:23<00:10, 30.07it/s] 70%|██████▉   | 695/1000 [00:23<00:10, 30.07it/s] 70%|██████▉   | 699/1000 [00:23<00:10, 30.07it/s] 70%|███████   | 703/1000 [00:24<00:09, 30.07it/s] 71%|███████   | 707/1000 [00:24<00:09, 30.07it/s] 71%|███████   | 711/1000 [00:24<00:09, 30.07it/s] 72%|███████▏  | 715/1000 [00:24<00:09, 30.07it/s] 72%|███████▏  | 719/1000 [00:24<00:09, 30.08it/s] 72%|███████▏  | 723/1000 [00:24<00:09, 30.08it/s] 73%|███████▎  | 727/1000 [00:24<00:09, 30.07it/s] 73%|███████▎  | 731/1000 [00:24<00:08, 30.07it/s] 74%|███████▎  | 735/1000 [00:25<00:08, 30.07it/s] 74%|███████▍  | 739/1000 [00:25<00:08, 30.07it/s] 74%|███████▍  | 743/1000 [00:25<00:08, 30.07it/s] 75%|███████▍  | 747/1000 [00:25<00:08, 30.07it/s] 75%|███████▌  | 751/1000 [00:25<00:08, 30.05it/s] 76%|███████▌  | 755/1000 [00:25<00:08, 30.06it/s] 76%|███████▌  | 759/1000 [00:25<00:08, 30.06it/s] 76%|███████▋  | 763/1000 [00:26<00:07, 30.07it/s] 77%|███████▋  | 767/1000 [00:26<00:07, 30.07it/s] 77%|███████▋  | 771/1000 [00:26<00:07, 30.08it/s] 78%|███████▊  | 775/1000 [00:26<00:07, 30.08it/s] 78%|███████▊  | 779/1000 [00:26<00:07, 30.08it/s] 78%|███████▊  | 783/1000 [00:26<00:07, 30.08it/s] 79%|███████▊  | 787/1000 [00:26<00:07, 30.08it/s] 79%|███████▉  | 791/1000 [00:26<00:06, 30.08it/s] 80%|███████▉  | 795/1000 [00:27<00:06, 30.09it/s] 80%|███████▉  | 799/1000 [00:27<00:06, 30.09it/s] 80%|████████  | 803/1000 [00:27<00:06, 30.08it/s] 81%|████████  | 807/1000 [00:27<00:06, 30.09it/s] 81%|████████  | 811/1000 [00:27<00:06, 30.08it/s] 82%|████████▏ | 815/1000 [00:27<00:06, 30.08it/s] 82%|████████▏ | 819/1000 [00:27<00:06, 30.08it/s] 82%|████████▏ | 823/1000 [00:28<00:05, 30.08it/s] 83%|████████▎ | 827/1000 [00:28<00:05, 30.08it/s] 83%|████████▎ | 831/1000 [00:28<00:05, 30.08it/s] 84%|████████▎ | 835/1000 [00:28<00:05, 30.09it/s] 84%|████████▍ | 839/1000 [00:28<00:05, 30.08it/s] 84%|████████▍ | 843/1000 [00:28<00:05, 30.08it/s] 85%|████████▍ | 847/1000 [00:28<00:05, 30.08it/s] 85%|████████▌ | 851/1000 [00:28<00:04, 30.09it/s] 86%|████████▌ | 855/1000 [00:29<00:04, 30.09it/s] 86%|████████▌ | 859/1000 [00:29<00:04, 30.09it/s] 86%|████████▋ | 863/1000 [00:29<00:04, 30.09it/s] 87%|████████▋ | 867/1000 [00:29<00:04, 30.09it/s] 87%|████████▋ | 871/1000 [00:29<00:04, 30.08it/s] 88%|████████▊ | 875/1000 [00:29<00:04, 30.08it/s] 88%|████████▊ | 879/1000 [00:29<00:04, 30.07it/s] 88%|████████▊ | 883/1000 [00:30<00:03, 30.07it/s] 89%|████████▊ | 887/1000 [00:30<00:03, 30.07it/s] 89%|████████▉ | 891/1000 [00:30<00:03, 30.08it/s] 90%|████████▉ | 895/1000 [00:30<00:03, 30.08it/s] 90%|████████▉ | 899/1000 [00:30<00:03, 30.08it/s] 90%|█████████ | 903/1000 [00:30<00:03, 30.08it/s] 91%|█████████ | 907/1000 [00:30<00:03, 30.08it/s] 91%|█████████ | 911/1000 [00:30<00:02, 30.09it/s] 92%|█████████▏| 915/1000 [00:31<00:02, 30.09it/s] 92%|█████████▏| 919/1000 [00:31<00:02, 30.09it/s] 92%|█████████▏| 923/1000 [00:31<00:02, 30.09it/s] 93%|█████████▎| 927/1000 [00:31<00:02, 30.09it/s] 93%|█████████▎| 931/1000 [00:31<00:02, 30.09it/s] 94%|█████████▎| 935/1000 [00:31<00:02, 30.09it/s] 94%|█████████▍| 939/1000 [00:31<00:02, 30.09it/s] 94%|█████████▍| 943/1000 [00:32<00:01, 30.09it/s] 95%|█████████▍| 947/1000 [00:32<00:01, 30.09it/s] 95%|█████████▌| 951/1000 [00:32<00:01, 30.09it/s] 96%|█████████▌| 955/1000 [00:32<00:01, 30.09it/s] 96%|█████████▌| 959/1000 [00:32<00:01, 30.08it/s] 96%|█████████▋| 963/1000 [00:32<00:01, 30.03it/s] 97%|█████████▋| 967/1000 [00:32<00:01, 30.05it/s] 97%|█████████▋| 971/1000 [00:32<00:00, 30.06it/s] 98%|█████████▊| 975/1000 [00:33<00:00, 30.06it/s] 98%|█████████▊| 979/1000 [00:33<00:00, 30.07it/s] 98%|█████████▊| 983/1000 [00:33<00:00, 30.07it/s] 99%|█████████▊| 987/1000 [00:33<00:00, 30.07it/s] 99%|█████████▉| 991/1000 [00:33<00:00, 30.08it/s]100%|█████████▉| 995/1000 [00:33<00:00, 30.08it/s]100%|█████████▉| 999/1000 [00:33<00:00, 30.08it/s]100%|██████████| 1000/1000 [00:33<00:00, 29.50it/s]
/gpfs/home6/scur1028/FairMI/train_bpr_fairmi.py:56: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3614.)
  neg_score[i] = torch.exp(torch.matmul(x_norm, z_norm[i].T) / tau).sum()
Traceback (most recent call last):
  File "/gpfs/home6/scur1028/FairMI/train_bpr_fairmi.py", line 224, in <module>
    train_unify_mi(sens_enc, inter_enc, club, dataset, u_sens, n_users, n_items, train_u2i, test_u2i, args)
  File "/gpfs/home6/scur1028/FairMI/train_bpr_fairmi.py", line 111, in train_unify_mi
    up = args.ureg * club.forward(e_zu[torch.unique(u)], e_zi[torch.unique(u)])
  File "/gpfs/home6/scur1028/FairMI/models/club.py", line 30, in forward
    mu, logvar = self.get_mu_logvar(x_samples)
  File "/gpfs/home6/scur1028/FairMI/models/club.py", line 26, in get_mu_logvar
    logvar = self.p_logvar(x_samples)
  File "/home/scur1028/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/scur1028/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur1028/.local/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/home/scur1028/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/scur1028/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/scur1028/.local/lib/python3.9/site-packages/torch/nn/modules/activation.py", line 356, in forward
    return torch.tanh(input)
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Namespace(bakcbone='bpr', dataset='./data/ml-1m/process/process.pkl', emb_size=64, hidden_size=256, lr=0.001, l2_reg=0.001, n_layers=3, batch_size=2048, num_workers=6, log_path='logs/bpr_fairmi.txt', param_path='param/bpr_fairmi.pth', pretrain_path='param/bpr_base.pth', lreg=0.1, ureg=0.1, train_step=50, num_epochs=500, device='cuda:0')
epoch: 1000, classify_loss: 0.002383

JOB STATISTICS
==============
Job ID: 5018484
Cluster: snellius
User/Group: scur1028/scur1028
State: RUNNING
Nodes: 1
Cores per node: 18
CPU Utilized: 00:00:00
CPU Efficiency: 0.00% of 00:14:42 core-walltime
Job Wall-clock time: 00:00:49
Memory Utilized: 0.00 MB (estimated maximum)
Memory Efficiency: 0.00% of 60.00 GB (60.00 GB/node)
WARNING: Efficiency statistics may be misleading for RUNNING jobs.
